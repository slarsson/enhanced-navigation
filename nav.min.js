"use strict";let enhanchedNavigation;if(!("Promise"in window))throw"ES6 NOT SUPPORTED, ABORT!";{window.addEventListener("DOMContentLoaded",()=>enhanchedNavigation.install()),window.onpopstate=event=>enhanchedNavigation.popstate(event);const inject=html=>{const doc=(new DOMParser).parseFromString(html,"text/html");document.title=doc.title,document.head.innerHTML!=doc.head.innerHTML&&document.head.parentNode.replaceChild(doc.head,document.head),document.body.parentNode.replaceChild(doc.body,document.body)},initProgressBar=()=>{let progress=document.createElement("div");progress.style.width="0px",progress.style.position="fixed",progress.style.height="3px",progress.style.backgroundColor="#00a3d9";let start,width=0,current=-1,maxwidth=0,speed=0,ok=!1;const animate=id=>{if(id!=current)return;let now=window.performance.now(),dt=now-start;if(start=now,width>maxwidth){if(ok)return void(progress.style.opacity="0")}else width+=dt*speed,progress.style.width=width+"px";requestAnimationFrame(()=>animate(id))};return{start:()=>{progress.style.trasition="opacity 0ms linear",progress.style.width="0px",progress.style.opacity="1",progress.style.transition="opacity 200ms linear",ok=!1,current++,start=window.performance.now(),width=-100,maxwidth=.9*window.innerWidth,speed=maxwidth/2e3,animate(current)},complete:()=>{ok=!0,maxwidth=window.innerWidth,speed=maxwidth/500},install:()=>{document.documentElement.insertBefore(progress,document.body)},setColor:color=>{progress.style.backgroundColor=color},setHeight:h=>{progress.style.height=h+"px"}}};enhanchedNavigation={hostname:window.location.hostname,progress:initProgressBar(),cache:new Map,lastRequest:null,cacheTTL:12e5},enhanchedNavigation.install=function(){this.progress.install(),this.hydrate()},enhanchedNavigation.handler=async function(event){const url=event.currentTarget.href;event.preventDefault(),this.progress.start();try{window.history.replaceState({scroll:document.documentElement.scrollTop},"",document.location.href);let html=await this.get(url);inject(html),this.progress.complete(),window.history.pushState({scroll:0},"",url),window.scrollTo(0,0),this.hydrate()}catch(err){window.location.href=url}},enhanchedNavigation.hydrate=function(){const nodes=document.querySelectorAll("a[href]");for(const node of nodes)node.hostname==this.hostname&&(node.onclick=event=>this.handler(event),null!=node.dataset.prefetch&&this.get(node.href))},enhanchedNavigation.get=function(url){return new Promise((resolve,reject)=>{let cachedPage=this.cache.get(url);void 0!==cachedPage&&cachedPage.ttl>Date.now()?resolve(cachedPage.body):fetch(url).then(resp=>resp.text()).then(html=>{resolve(html),this.cache.set(url,{body:html,ttl:Date.now()+this.cacheTTL})}).catch(err=>reject(err))})},enhanchedNavigation.popstate=async function(event){this.progress.start(),inject(await this.get(document.location.href)),this.progress.complete(),window.scrollTo(0,void 0!==event.state.scroll?event.state.scroll:0),this.hydrate()}}